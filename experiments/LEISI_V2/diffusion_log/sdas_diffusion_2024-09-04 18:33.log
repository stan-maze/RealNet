[2024-09-04 18:33:27,874][train_diffusion.py][line: 122][    INFO] args: Namespace(class_name_list=['leisi_norm'], config='experiments/LEISI_V2/diffusion.yaml', dataset='LEISI_V2', local_rank=0)
[2024-09-04 18:33:27,876][train_diffusion.py][line: 123][    INFO] config: {'TestSampler': {'T': 1000,
                 'beta_scheduler': 'linear',
                 'rescale_timesteps': False,
                 'section_counts': 'ddim20'},
 'TrainSampler': {'T': 1000,
                  'beta_scheduler': 'linear',
                  'rescale_timesteps': False,
                  'section_counts': 'ddim1000'},
 'checkpoints_path': 'experiments/LEISI_V2/diffusion_checkpoints/',
 'criterion': [{'kwargs': {'weight': 1.0},
                'name': 'ImageMSELoss',
                'type': 'ImageMSELoss'}],
 'dataset': {'batch_size': 1,
             'class_name_list': ['leisi_norm'],
             'image_reader': {'kwargs': {'color_mode': 'RGB',
                                         'image_dir': './data/LEISI_V2/leisi/'},
                              'type': 'opencv'},
             'input_size': [256, 256],
             'pixel_mean': [0.278, 0.278, 0.278],
             'pixel_std': [0.238, 0.238, 0.238],
             'test': {'meta_file': './data/LEISI_V2/samples/diff_train_uni.json'},
             'train': {'hflip': False,
                       'meta_file': './data/LEISI_V2/samples/diff_train_uni.json',
                       'rotate': False,
                       'vflip': False},
             'type': 'sdas',
             'workers': 4},
 'exp_path': 'experiments/LEISI_V2',
 'log_path': 'experiments/LEISI_V2/diffusion_log/',
 'random_seed': 100,
 'saver': {'checkpoints_dir': 'diffusion_checkpoints/',
           'log_dir': 'diffusion_log/',
           'vis_dir': 'diffusion_vis/'},
 'trainer': {'accumulate': 3,
             'clip_max_norm': 1.0,
             'ema_decay': 0.9999,
             'max_epoch': 1000,
             'optimizer': {'kwargs': {'betas': [0.9, 0.999],
                                      'lr': 0.0001,
                                      'weight_decay': 0},
                           'type': 'Adam'},
             'print_freq_step': 30,
             'use_fp16': False,
             'val_batch_number': 6,
             'val_freq_epoch': 10},
 'unet': {'attention_resolutions': [32, 16, 8],
          'channel_mult': [1, 1, 2, 2, 4, 4],
          'class_number': 15,
          'classifier_depth': 2,
          'classifier_width': 256,
          'dropout': 0.0,
          'image_size': 256,
          'learn_sigma': True,
          'num_head_channels': 64,
          'num_heads': 4,
          'num_heads_upsample': -1,
          'pertrain_path': 'pretrain/256x256_diffusion.pt',
          'resblock_updown': True,
          'use_fp16': False,
          'use_scale_shift_norm': True},
 'version': 'v1.0.0',
 'vis_path': 'experiments/LEISI_V2/diffusion_vis/'}
[2024-09-04 18:33:27,876][train_diffusion.py][line: 124][    INFO] train_loader len is 60
